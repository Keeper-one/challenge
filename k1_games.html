<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ألعاب K1</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, signInWithCustomToken } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, collection, addDoc } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        import { setLogLevel } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        
        // Use the firebase config provided by the environment
        const firebaseConfig = JSON.parse(typeof __firebase_config !== 'undefined' ? __firebase_config : '{}');

        const app = initializeApp(firebaseConfig);
        // Set Firestore log level to debug
        setLogLevel('debug');
        const db = getFirestore(app);
        const auth = getAuth(app);
        
        let userId = null;
        let isAuthReady = false;
        
        const signIn = async () => {
            try {
                if (typeof __initial_auth_token !== 'undefined') {
                    await signInWithCustomToken(auth, __initial_auth_token);
                } else {
                    await signInAnonymously(auth);
                }
                userId = auth.currentUser.uid;
            } catch (error) {
                console.error("Firebase Auth error:", error);
                userId = crypto.randomUUID();
            } finally {
                isAuthReady = true;
            }
        };

        signIn();

        // Global Game Variables
        let playerName = '';
        let playerPhone = '';
        let currentGameId = '';
        let currentTotalScore = 0;
        let goalkeeperUsed = '';
        const totalRounds = 5;
        let roundsPlayed = 0;

        // DOM Elements
        const mainContent = document.getElementById('main-content');
        const loginSection = document.getElementById('login-section');
        const playerNameInput = document.getElementById('playerNameInput');
        const playerPhoneInput = document.getElementById('playerPhoneInput');
        const startGamesButton = document.getElementById('startGamesButton');
        const gameContainer = document.getElementById('game-container');
        const gameMessage = document.getElementById('game-message');
        const scoreDisplay = document.getElementById('score-display');
        const finalScoreSection = document.getElementById('final-score-section');
        const finalScoreDisplay = document.getElementById('final-score-display');
        const submitScoreButton = document.getElementById('submitScoreButton');
        const popup = document.getElementById('popup');
        const popupMessage = document.getElementById('popupMessage');
        const closePopupButton = document.getElementById('closePopupButton');

        // Game specific sections
        const reactionSection = document.getElementById('reaction-section');
        const guessSection = document.getElementById('guess-section');
        const timingSection = document.getElementById('timing-section');
        const directionSection = document.getElementById('direction-section');
        const ballThrowSection = document.getElementById('ball-throw-section');

        // Game specific elements
        const reactionBox = document.getElementById('reaction-box');
        const guessNumber1 = document.getElementById('guess-number-1');
        const guessNumber2 = document.getElementById('guess-number-2');
        const guessSmallerBtn = document.getElementById('guess-smaller');
        const guessLargerBtn = document.getElementById('guess-larger');
        const timingTimer = document.getElementById('timing-timer');
        const timingTarget = document.getElementById('timing-target');
        const timingStopBtn = document.getElementById('timing-stop-btn');
        const directionLeftBtn = document.getElementById('direction-left-btn');
        const directionRightBtn = document.getElementById('direction-right-btn');
        const directionGoalie = document.getElementById('direction-goalie');
        const throwBallBtn = document.getElementById('throw-ball-btn');
        const throwTarget = document.getElementById('throw-target');
        const throwResult = document.getElementById('throw-result');

        // Reaction Game specific elements & variables
        const targetColorDisplay = document.getElementById('target-color-display');
        const colorButtonsContainer = document.getElementById('color-buttons-container');
        const resultsTable = document.getElementById('results-table');
        const colors = ['#ef4444', '#f97316', '#eab308', '#22c55e', '#3b82f6', '#8b5cf6'];
        let targetColor;
        let roundStartTime;
        let gameActive = false;
        const roundResults = [];


        // Goalkeeper details and messages
        const goalkeepers = {
            'الأسد': 'ردة فعل سريعة مثل مخلب الأسد!',
            'الصقر': 'دقة عالية مثل عين الصقر!',
            'النمر': 'قوة هائلة في التصدي مثل النمر!',
            'الفهد': 'سرعة لا مثيل لها مثل الفهد!',
            'الذئب': 'ذكاء حاد وتوقع صحيح مثل الذئب!'
        };
        const gkNames = Object.keys(goalkeepers);

        const motivationalMessages = {
            correct: [
                "تصدي مذهل!", "هكذا يفعل الأساطير!", "قفازك هو الأفضل في العالم!", "بطل، بطل، بطل!",
                "قوة حقيقية! لا يمكن لأحد أن يتجاوزك!", "مستحيل! لقد تصديت لها كالجدار!"
            ],
            incorrect: [
                "لا تقلق، الأخطاء هي بداية النجومية!", "تعلم من كل تسديدة!", "هذه هي الخبرة الحقيقية!", "كن أفضل في المرة القادمة!",
                "حتى الأساطير يخطئون، عد أقوى!", "كل هفوة هي فرصة للتحسن!"
            ],
            promo: [
                "تألق مثل الأساطير! قفازات K1 تمنحك الثبات والقوة.",
                "قوة التصدي تبدأ بقفازات K1. احصل على قفازاتك الآن!",
                "هل أنت مستعد لمواجهة التحدي؟ قفازات K1 هي سلاحك السري!",
                "لا يوجد شيء اسمه مستحيل مع قفازات K1. كن الحارس الذي لطالما حلمت به."
            ],
            final: [
                "لقد أثبت جدارتك! شارك نتيجتك مع أصدقائك، ولا تنسى متابعة Keeper1gk@ على الإنستغرام، تيك توك وسناب شات. قفازات K1 بانتظارك!",
                "ألف مبروك يا أسطورة! انضم إلى مجتمع Keeper1gk@ على الإنستغرام، تيك توك وسناب شات لتكون جزءاً من فريق الأبطال. قفازاتنا هي سلاحك الجديد!"
            ]
        };

        // --- General Functions ---
        function showPopup(message) {
            popupMessage.innerHTML = message;
            popup.classList.remove('hidden');
        }

        async function submitScore() {
            if (!isAuthReady || !userId) {
                console.error("Firebase not ready or user not authenticated.");
                showPopup("خطأ: لم يتم الاتصال بقاعدة البيانات. الرجاء المحاولة مرة أخرى.");
                return;
            }

            try {
                const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
                const leaderboardCollectionRef = collection(db, `artifacts/${appId}/public/data/leaderboard`);
                await addDoc(leaderboardCollectionRef, {
                    gameId: currentGameId,
                    userId: userId,
                    name: playerName,
                    phone: playerPhone,
                    score: currentTotalScore,
                    goalkeeperUsed: goalkeeperUsed,
                    timestamp: new Date().toISOString()
                });
                showPopup(motivationalMessages.final[Math.floor(Math.random() * motivationalMessages.final.length)]);
            } catch (error) {
                console.error("Error submitting score:", error);
                showPopup("حدث خطأ أثناء إرسال النتيجة. الرجاء مراجعة وحدة تحكم المتصفح.");
            }
        }

        function showGame(gameId) {
            document.querySelectorAll('.game-section').forEach(section => section.classList.add('hidden'));
            gameContainer.classList.add('hidden');
            finalScoreSection.classList.add('hidden');
            finalScoreDisplay.textContent = '';
            currentTotalScore = 0;
            roundsPlayed = 0;
            goalkeeperUsed = gkNames[Math.floor(Math.random() * gkNames.length)];
            roundResults.length = 0; // Clear results for new game
            updateResultsTable(); // Clear table

            currentGameId = gameId;

            let sectionToShow;
            if (gameId === 'reaction-challenge') sectionToShow = reactionSection;
            else if (gameId === 'guess-challenge') sectionToShow = guessSection;
            else if (gameId === 'timing-challenge') sectionToShow = timingSection;
            else if (gameId === 'direction-challenge') sectionToShow = directionSection;
            else if (gameId === 'ball-throw-challenge') sectionToShow = ballThrowSection;

            if (sectionToShow) {
                sectionToShow.classList.remove('hidden');
                gameContainer.classList.remove('hidden');
                gameMessage.textContent = `${goalkeepers[goalkeeperUsed]} استعد يا بطل!`;
                updateScoreDisplay();
                
                if (gameId === 'reaction-challenge') startReactionGame();
                else if (gameId === 'guess-challenge') startGuessGame();
                else if (gameId === 'timing-challenge') startTimingGame();
                else if (gameId === 'direction-challenge') startDirectionGame();
                else if (gameId === 'ball-throw-challenge') startBallThrowGame();
            }
        }

        function updateScoreDisplay() {
            // In the new reaction game, a lower score is better.
            scoreDisplay.textContent = `النتيجة الإجمالية (بالمللي ثانية): ${currentTotalScore}`;
        }

        function updateResultsTable() {
            const tableBody = resultsTable.querySelector('tbody');
            tableBody.innerHTML = '';
            roundResults.forEach((result, index) => {
                const row = tableBody.insertRow();
                const cell1 = row.insertCell(0);
                const cell2 = row.insertCell(1);
                const cell3 = row.insertCell(2);
                cell1.textContent = index + 1;
                cell2.textContent = `${result.time} ms`;
                cell3.textContent = result.correct ? 'صحيح ✓' : 'خطأ ✗';
                row.classList.add('bg-gray-700', 'text-gray-200');
            });
        }
        
        function checkEndGame() {
            if (roundsPlayed >= totalRounds) {
                finalScoreSection.classList.remove('hidden');
                finalScoreDisplay.textContent = `النتيجة النهائية (مجموع الأوقات): ${currentTotalScore} ms`;
                submitScoreButton.classList.remove('hidden');
            } else {
                gameMessage.textContent = `الجولة ${roundsPlayed + 1} من ${totalRounds}. ${goalkeepers[goalkeeperUsed]}`;
                setTimeout(() => {
                    if (currentGameId === 'reaction-challenge') startReactionGame();
                    else if (currentGameId === 'guess-challenge') startGuessGame();
                    else if (currentGameId === 'timing-challenge') startTimingGame();
                    else if (currentGameId === 'direction-challenge') startDirectionGame();
                    else if (currentGameId === 'ball-throw-challenge') startBallThrowGame();
                }, 1500);
            }
        }
        
        // --- Reaction Game ---
        function startReactionGame() {
            // Disable buttons until a color appears
            colorButtonsContainer.querySelectorAll('button').forEach(btn => btn.disabled = true);
            
            // Hide the target color display and show 'wait' message
            targetColorDisplay.style.backgroundColor = 'transparent';
            targetColorDisplay.textContent = 'انتظر...';
            gameActive = false;

            const delay = Math.random() * 2000 + 1000; // 1-3 seconds delay
            setTimeout(() => {
                targetColor = colors[Math.floor(Math.random() * colors.length)];
                targetColorDisplay.style.backgroundColor = targetColor;
                targetColorDisplay.textContent = '';
                gameActive = true;
                roundStartTime = Date.now();
                // Enable buttons
                colorButtonsContainer.querySelectorAll('button').forEach(btn => btn.disabled = false);
            }, delay);
        }

        function handleColorButtonClick(event) {
            if (!gameActive) {
                showPopup("لا تتعجل! انتظر ظهور اللون.");
                return;
            }

            gameActive = false;
            const clickedColor = event.target.dataset.color;
            const reactionTime = Date.now() - roundStartTime;
            const isCorrect = clickedColor === targetColor;
            
            const penalty = 5000;

            let message = '';
            if (isCorrect) {
                currentTotalScore += reactionTime;
                message = `صحيح! ردة فعلك: ${reactionTime} ms. ${motivationalMessages.correct[Math.floor(Math.random() * motivationalMessages.correct.length)]}`;
            } else {
                currentTotalScore += penalty;
                message = `خطأ! اللون الصحيح هو ${targetColor}. ردة فعلك: ${reactionTime} ms. ${motivationalMessages.incorrect[Math.floor(Math.random() * motivationalMessages.incorrect.length)]} (عقوبة ${penalty} ms)`;
            }

            roundResults.push({
                time: isCorrect ? reactionTime : penalty,
                correct: isCorrect
            });
            updateResultsTable();
            updateScoreDisplay();
            showPopup(message);
            roundsPlayed++;
            checkEndGame();
        }

        // Dynamically create the color buttons
        function createColorButtons() {
            colorButtonsContainer.innerHTML = '';
            colors.forEach(color => {
                const button = document.createElement('button');
                button.dataset.color = color;
                button.classList.add('w-20', 'h-20', 'rounded-full', 'transition-all', 'duration-150', 'ease-in-out', 'transform', 'hover:scale-110');
                button.style.backgroundColor = color;
                button.addEventListener('click', handleColorButtonClick);
                colorButtonsContainer.appendChild(button);
            });
        }


        // --- Guess Game ---
        function startGuessGame() {
            const num1 = Math.floor(Math.random() * 100) + 1;
            const num2 = Math.floor(Math.random() * 100) + 1;
            guessNumber1.textContent = num1;
            guessNumber2.textContent = num2;
            gameActive = true;
        }

        function checkGuess(isSmallerGuess) {
            if (!gameActive) return;
            const num1 = parseInt(guessNumber1.textContent);
            const num2 = parseInt(guessNumber2.textContent);
            let correct = false;
            if (isSmallerGuess && num1 < num2) correct = true;
            if (!isSmallerGuess && num1 > num2) correct = true;

            let score = correct ? 1000 : 0;
            currentTotalScore += score;
            updateScoreDisplay();
            showPopup(correct ? motivationalMessages.correct[Math.floor(Math.random() * motivationalMessages.correct.length)] : motivationalMessages.incorrect[Math.floor(Math.random() * motivationalMessages.incorrect.length)]);
            roundsPlayed++;
            checkEndGame();
        }

        // --- Timing Game ---
        let timingInterval;
        let targetTiming;
        function startTimingGame() {
            timingTimer.textContent = '0.000';
            targetTiming = Math.random() * (10 - 3) + 3;
            timingTarget.textContent = `الهدف: ${targetTiming.toFixed(3)} ثانية`;
            gameActive = true;
            gameStartTime = Date.now();
            timingInterval = setInterval(() => {
                timingTimer.textContent = ((Date.now() - gameStartTime) / 1000).toFixed(3);
            }, 10);
        }
        function stopTimingGame() {
            if (!gameActive) return;
            gameActive = false;
            clearInterval(timingInterval);
            const finalTime = parseFloat(timingTimer.textContent);
            const deviation = Math.abs(finalTime - targetTiming);

            let score = 0;
            if (deviation <= 0.5) {
                score = Math.max(0, 1000 - Math.floor(deviation * 1000));
            }
            currentTotalScore += score;
            updateScoreDisplay();
            showPopup(`توقيتك ${finalTime.toFixed(3)}! نقاطك: ${score}. حارس المرمى لا يترك شيئًا للصدفة!`);
            roundsPlayed++;
            checkEndGame();
        }

        // --- Direction Game ---
        let correctDirection;
        function startDirectionGame() {
            const directions = ['left', 'right'];
            correctDirection = directions[Math.floor(Math.random() * directions.length)];
            directionGoalie.style.transform = 'translateX(0)';
            directionLeftBtn.disabled = false;
            directionRightBtn.disabled = false;
            gameActive = true;
            setTimeout(() => {
                directionGoalie.style.transition = 'transform 0.5s ease-in-out';
                if (correctDirection === 'left') {
                    directionGoalie.style.transform = 'translateX(-150px)';
                } else {
                    directionGoalie.style.transform = 'translateX(150px)';
                }
            }, 500);
        }

        function checkDirection(guess) {
            if (!gameActive) return;
            gameActive = false;
            const isCorrect = (guess === correctDirection);
            let score = isCorrect ? 1000 : 0;
            currentTotalScore += score;
            updateScoreDisplay();
            showPopup(isCorrect ? "تصدي مذهل! قراءة صحيحة للعبة!" : "توقع خاطئ. لكن لكل حارس تصدياته وإخفاقاته!");
            directionLeftBtn.disabled = true;
            directionRightBtn.disabled = true;
            roundsPlayed++;
            checkEndGame();
        }

        // --- Ball Throw Game ---
        function startBallThrowGame() {
            throwBallBtn.classList.remove('hidden');
            throwTarget.classList.remove('hidden');
            throwResult.textContent = '';
            gameActive = true;
        }
        function checkThrow() {
            if (!gameActive) return;
            gameActive = false;
            const throwStrength = Math.random() * 100;
            let score = 0;
            let message = '';
            if (throwStrength > 90) {
                score = 1000;
                message = motivationalMessages.promo[Math.floor(Math.random() * motivationalMessages.promo.length)];
            } else if (throwStrength > 70) {
                score = 750;
                message = "رمية جيدة جداً! قفازك يثبت قوته!";
            } else if (throwStrength > 50) {
                score = 500;
                message = "رمية مقبولة. نحتاج للمزيد من التركيز في المرة القادمة.";
            } else {
                score = 250;
                message = "رمية ضعيفة! عليك بالتدريب أكثر يا حارس المرمى.";
            }
            currentTotalScore += score;
            updateScoreDisplay();
            throwResult.textContent = message;
            showPopup(message);
            roundsPlayed++;
            checkEndGame();
        }

        document.addEventListener('DOMContentLoaded', () => {
            // Assign event listeners
            closePopupButton.addEventListener('click', () => {
                popup.classList.add('hidden');
            });
            startGamesButton.addEventListener('click', () => {
                playerName = playerNameInput.value.trim();
                playerPhone = playerPhoneInput.value.trim();
                if (playerName && playerPhone) {
                    loginSection.classList.add('hidden');
                    mainContent.classList.remove('hidden');
                    const hash = window.location.hash;
                    // Check if there is a hash in the URL, otherwise, start a default game
                    if (hash) {
                        showGame(hash.substring(1));
                    } else {
                        // If no game is specified in the URL, start the first game by default
                        showGame('reaction-challenge');
                    }
                } else {
                    showPopup("الرجاء إدخال اسمك ورقم هاتفك للمتابعة.");
                }
            });
            submitScoreButton.addEventListener('click', submitScore);
            guessSmallerBtn.addEventListener('click', () => checkGuess(true));
            guessLargerBtn.addEventListener('click', () => checkGuess(false));
            timingStopBtn.addEventListener('click', stopTimingGame);
            directionLeftBtn.addEventListener('click', () => checkDirection('left'));
            directionRightBtn.addEventListener('click', () => checkDirection('right'));
            throwBallBtn.addEventListener('click', checkThrow);

            // Dynamically create the color buttons
            createColorButtons();

            window.addEventListener('hashchange', () => {
                if (playerName && playerPhone) {
                    const hash = window.location.hash;
                    if (hash) showGame(hash.substring(1));
                }
            });

            // Initial game start if URL has a hash
            if (playerName && playerPhone) {
                const hash = window.location.hash;
                if (hash) showGame(hash.substring(1));
            }
        });
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap');
        body {
            font-family: 'Tajawal', sans-serif;
            background-color: #121212;
            color: #e0e0e0;
            line-height: 1.6;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }
        .container {
            max-width: 800px;
            margin: 2rem;
            padding: 2.5rem;
            background-color: #1e1e1e;
            border-radius: 1.5rem;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            text-align: center;
            border: 2px solid #2a2a2a;
        }
        .header {
            font-size: 2.5rem;
            font-weight: bold;
            color: #fcd34d;
            margin-bottom: 0.5rem;
        }
        .button {
            padding: 0.75rem 1.5rem;
            font-size: 1rem;
            font-weight: bold;
            border-radius: 0.75rem;
            transition: all 0.3s ease;
        }
        .primary-btn {
            background-color: #3b82f6;
            color: white;
        }
        .primary-btn:hover {
            background-color: #2563eb;
            transform: scale(1.05);
            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.4);
        }
        .input-field {
            background-color: #333;
            border: 1px solid #444;
            color: #e0e0e0;
            border-radius: 0.75rem;
            padding: 0.75rem;
        }
        .input-field:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.5);
        }
        .hidden {
            display: none;
        }
        .popup-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        .popup-content {
            background-color: #1e1e1e;
            padding: 2rem;
            border-radius: 1rem;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
            text-align: center;
            max-width: 400px;
            width: 90%;
            position: relative;
        }
        .close-btn {
            position: absolute;
            top: 0.75rem;
            right: 0.75rem;
            background: none;
            border: none;
            font-size: 1.5rem;
            color: #888;
            cursor: pointer;
        }
        .game-section {
            border: 2px solid #555;
            border-radius: 1rem;
            padding: 2rem;
            margin-top: 1.5rem;
            background-color: #2c2c2c;
        }
        .reaction-box {
            width: 200px;
            height: 200px;
            background-color: red;
            margin: 0 auto;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.5rem;
            font-weight: bold;
            color: white;
            border-radius: 1rem;
            transition: background-color 0.3s ease, transform 0.2s ease;
        }
        .reaction-box:active {
            transform: scale(0.95);
        }
        .direction-goalie {
            width: 50px;
            height: 50px;
            background-color: #fcd34d;
            border-radius: 50%;
            margin: 0 auto;
            position: relative;
        }
        .ball-target {
            width: 100px;
            height: 100px;
            border: 3px solid #fcd34d;
            border-radius: 50%;
            margin: 2rem auto;
            position: relative;
        }
        .results-table {
            width: 100%;
            margin-top: 1.5rem;
            border-collapse: collapse;
        }
        .results-table th, .results-table td {
            padding: 0.75rem;
            border: 1px solid #444;
        }
        .results-table th {
            background-color: #4a4a4a;
        }
        .color-buttons-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 1.5rem;
            margin-top: 1.5rem;
        }
        .target-color-display {
            width: 100%;
            min-height: 100px;
            border-radius: 1rem;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.25rem;
            font-weight: bold;
            color: white;
            transition: background-color 0.3s ease-in-out;
            border: 2px solid #4a4a4a;
            margin-bottom: 1.5rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <a href="index.html" class="back-button absolute top-6 right-6">العودة إلى الصفحة الرئيسية</a>
        <div id="login-section">
            <h1 class="header mb-4">انضم لفريق K1!</h1>
            <p class="text-lg text-gray-300 mb-6">قبل البدء، أدخل بياناتك:</p>
            <div class="space-y-4">
                <input type="text" id="playerNameInput" placeholder="أدخل اسمك" class="input-field w-full">
                <input type="tel" id="playerPhoneInput" placeholder="أدخل رقم هاتفك" class="input-field w-full">
                <button id="startGamesButton" class="button primary-btn w-full">ابدأ الألعاب</button>
            </div>
        </div>

        <div id="main-content" class="hidden">
            <h1 class="header mb-4">ألعاب K1</h1>
            <p id="game-message" class="text-lg text-gray-400 mb-4"></p>
            <p id="score-display" class="text-xl font-bold mb-6"></p>

            <div id="game-container" class="space-y-6">
                <!-- Reaction Challenge -->
                <div id="reaction-section" class="game-section hidden">
                    <h2 class="text-2xl font-bold mb-4">تحدي ردة الفعل</h2>
                    <div id="target-color-display" class="target-color-display">انتظر...</div>
                    <div id="color-buttons-container" class="color-buttons-container"></div>
                    <table id="results-table" class="results-table hidden">
                        <thead>
                            <tr class="bg-gray-800 text-yellow-400">
                                <th>الجولة</th>
                                <th>الوقت</th>
                                <th>الحالة</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>

                <!-- Guess Challenge -->
                <div id="guess-section" class="game-section hidden">
                    <h2 class="text-2xl font-bold mb-4">اختر الأصغر/الأكبر</h2>
                    <div class="flex justify-center items-center space-x-8 text-4xl font-bold mb-6">
                        <span id="guess-number-1">0</span>
                        <span> vs </span>
                        <span id="guess-number-2">0</span>
                    </div>
                    <div class="flex justify-center space-x-4">
                        <button id="guess-smaller" class="button primary-btn">الأصغر</button>
                        <button id="guess-larger" class="button primary-btn">الأكبر</button>
                    </div>
                </div>

                <!-- Timing Challenge -->
                <div id="timing-section" class="game-section hidden">
                    <h2 class="text-2xl font-bold mb-4">التوقيت المثالي</h2>
                    <div id="timing-target" class="text-xl font-medium mb-4">الهدف: 0.000 ثانية</div>
                    <div id="timing-timer" class="text-5xl font-bold text-yellow-400 mb-6">0.000</div>
                    <button id="timing-stop-btn" class="button primary-btn">إيقاف المؤقت</button>
                </div>

                <!-- Direction Challenge -->
                <div id="direction-section" class="game-section hidden">
                    <h2 class="text-2xl font-bold mb-4">تحديد الاتجاه</h2>
                    <div class="flex justify-center items-center h-24 mb-6">
                        <div id="direction-goalie" class="direction-goalie"></div>
                    </div>
                    <div class="flex justify-center space-x-4">
                        <button id="direction-left-btn" class="button primary-btn">يسار</button>
                        <button id="direction-right-btn" class="button primary-btn">يمين</button>
                    </div>
                </div>

                <!-- Ball Throw Challenge -->
                <div id="ball-throw-section" class="game-section hidden">
                    <h2 class="text-2xl font-bold mb-4">رمي الكرة</h2>
                    <div class="flex justify-center space-x-4">
                        <div id="throw-target" class="ball-target"></div>
                    </div>
                    <p id="throw-result" class="text-lg font-bold mt-4 mb-6"></p>
                    <button id="throw-ball-btn" class="button primary-btn">ارمي الكرة</button>
                </div>
            </div>

            <!-- Final Score Section -->
            <div id="final-score-section" class="mt-8 hidden">
                <p id="final-score-display" class="text-2xl font-bold text-green-400 mb-4"></p>
                <button id="submitScoreButton" class="button primary-btn w-full">أرسل النتيجة</button>
            </div>
        </div>
    </div>

    <!-- Custom Popup -->
    <div id="popup" class="popup-overlay hidden">
        <div class="popup-content">
            <button id="closePopupButton" class="close-btn">&times;</button>
            <p id="popupMessage" class="text-center font-semibold"></p>
        </div>
    </div>
</body>
</html>
